{"ast":null,"code":"import _objectSpread from\"/Users/coles/Documents/brett/react/shapes/app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"/Users/coles/Documents/brett/react/shapes/app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/Users/coles/Documents/brett/react/shapes/app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/coles/Documents/brett/react/shapes/app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/coles/Documents/brett/react/shapes/app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/coles/Documents/brett/react/shapes/app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/coles/Documents/brett/react/shapes/app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from\"react\";import Canvg from\"canvg\";// import logo from \"./logo.svg\";\n// import icon from \"../ic.svg\";\nimport Konva from\"konva\";import{Stage,Layer,Image,Rect}from\"react-konva\";import SvgRender from\"./svgRender\";import{placement,placeInZone,placementInter}from\"../helpers.js/placement\";var Canvas=/*#__PURE__*/function(_Component){_inherits(Canvas,_Component);function Canvas(props){var _this;_classCallCheck(this,Canvas);_this=_possibleConstructorReturn(this,_getPrototypeOf(Canvas).call(this,props));_this.posAllShapes=function(){_this.savedRender=[];_this.setState({shapes:placement(_this.props.shapes,window.innerWidth,window.innerHeight)},function(){// this.saveFile();\n// this.saveImage();\n});};_this.savedRender=[];_this.textFile=null;_this.makeTextFile=function(text){var data=new Blob([text],{type:\"text/plain\"});// If we are replacing a previously generated file we need to\n// manually revoke the object URL to avoid memory leaks.\nif(_this.textFile!==null){window.URL.revokeObjectURL(_this.textFile);}_this.textFile=window.URL.createObjectURL(data);// returns a URL you can use as a href\nreturn _this.textFile;};_this.saveFile=function(){// var create = document.getElementById(\"create\");\n// create.addEventListener(\n//   \"click\",\n//   function() {\n//     var link = document.createElement(\"a\");\n//     link.setAttribute(\"download\", \"shapes.txt\");\n//     link.href = this.makeTextFile(JSON.stringify(this.state.shapes));\n//     document.body.appendChild(link);\n//     // wait for the link to be added to the document\n//     window.requestAnimationFrame(function() {\n//       var event = new MouseEvent(\"click\");\n//       link.dispatchEvent(event);\n//       document.body.removeChild(link);\n//     });\n//   },\n//   false\n// );\n_this.downloadURI(_this.makeTextFile(JSON.stringify(_this.savedRender)),\"shapes.json\");};_this.downloadURI=function(uri,name){var link=document.createElement(\"a\");link.download=name;link.href=uri;document.body.appendChild(link);link.click();document.body.removeChild(link);};_this.saveImage=function(){var dataURL=_this.stageRef.current.getStage().toDataURL({pixelRatio:3});_this.downloadURI(dataURL,\"stage.png\");};_this.renderArrayOfShapes=function(shape){var array=[];var loopShape=[];var count=0;while(array.length<shape.numToRender||count<1000){var x=placeInZone(window.innerWidth-_this.state.sideBar);var y=placeInZone(window.innerHeight);var noIn=true;// let pos=placementInter( window,[...this.savedRender,...loopShape] )\nvar otherBodys=[].concat(loopShape,_toConsumableArray(_this.savedRender));for(var i=0;i<otherBodys.flat().length;i++){var pos=otherBodys.flat()[i];if(pos.pos&&x>pos.pos.x-100&&x<pos.pos.x+100&&y>pos.pos.y-100&&y<pos.pos.y+100){console.log(\"overlap\");noIn=false;count++;}// console.log(pos.pos, \"pos\");\n}if(noIn){array.push(React.createElement(SvgRender,{key:y,src:shape.image,x:x,y:y,scale:shape.minSize}));loopShape.push(_objectSpread({},shape,{pos:{x:x,y:y}}));}}_this.savedRender.push(loopShape);return array;};_this.shapeRender=function(){var render=_this.state.shapes.map(function(shape){return _this.renderArrayOfShapes(shape);});// this.savedRender = render;\nreturn render;};_this.state={shapes:[],sideBar:600};_this.stageRef=React.createRef();return _this;}_createClass(Canvas,[{key:\"render\",value:function render(){return React.createElement(React.Fragment,null,React.createElement(Stage,{ref:this.stageRef,width:window.innerWidth-this.state.sideBar,height:window.innerHeight},React.createElement(Layer,null,React.createElement(Rect,{x:0,y:0,width:window.innerWidth-this.state.sideBar,height:window.innerHeight,fill:\"white\"})),React.createElement(Layer,null,this.shapeRender())),React.createElement(\"div\",{style:{display:\"flex\",flexDirection:\"column\"}},React.createElement(\"button\",{onClick:this.posAllShapes},\"mix\"),React.createElement(\"button\",{onClick:this.saveImage},\"Save Image\"),React.createElement(\"button\",{onClick:this.saveFile},\"Save set\")),React.createElement(\"div\",{id:\"create\"}));}}]);return Canvas;}(Component);export default Canvas;","map":{"version":3,"sources":["/Users/coles/Documents/brett/react/shapes/app/src/componets/canvas.js"],"names":["React","Component","Canvg","Konva","Stage","Layer","Image","Rect","SvgRender","placement","placeInZone","placementInter","Canvas","props","posAllShapes","savedRender","setState","shapes","window","innerWidth","innerHeight","textFile","makeTextFile","text","data","Blob","type","URL","revokeObjectURL","createObjectURL","saveFile","downloadURI","JSON","stringify","uri","name","link","document","createElement","download","href","body","appendChild","click","removeChild","saveImage","dataURL","stageRef","current","getStage","toDataURL","pixelRatio","renderArrayOfShapes","shape","array","loopShape","count","length","numToRender","x","state","sideBar","y","noIn","otherBodys","i","flat","pos","console","log","push","image","minSize","shapeRender","render","map","createRef","display","flexDirection"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Canvg from \"canvg\";\n// import logo from \"./logo.svg\";\n// import icon from \"../ic.svg\";\nimport Konva from \"konva\";\nimport { Stage, Layer, Image, Rect } from \"react-konva\";\nimport SvgRender from \"./svgRender\";\nimport {\n  placement,\n  placeInZone,\n  placementInter\n} from \"../helpers.js/placement\";\nclass Canvas extends Component {\n  constructor(props) {\n    super(props);\n    this.state = { shapes: [], sideBar: 600 };\n    this.stageRef = React.createRef();\n  }\n  posAllShapes = () => {\n    this.savedRender = [];\n    this.setState(\n      {\n        shapes: placement(\n          this.props.shapes,\n          window.innerWidth,\n          window.innerHeight\n        )\n      },\n      () => {\n        // this.saveFile();\n        // this.saveImage();\n      }\n    );\n  };\n  savedRender = [];\n  textFile = null;\n\n  makeTextFile = text => {\n    var data = new Blob([text], { type: \"text/plain\" });\n\n    // If we are replacing a previously generated file we need to\n    // manually revoke the object URL to avoid memory leaks.\n    if (this.textFile !== null) {\n      window.URL.revokeObjectURL(this.textFile);\n    }\n\n    this.textFile = window.URL.createObjectURL(data);\n\n    // returns a URL you can use as a href\n    return this.textFile;\n  };\n\n  saveFile = () => {\n    // var create = document.getElementById(\"create\");\n    // create.addEventListener(\n    //   \"click\",\n    //   function() {\n    //     var link = document.createElement(\"a\");\n    //     link.setAttribute(\"download\", \"shapes.txt\");\n    //     link.href = this.makeTextFile(JSON.stringify(this.state.shapes));\n    //     document.body.appendChild(link);\n\n    //     // wait for the link to be added to the document\n    //     window.requestAnimationFrame(function() {\n    //       var event = new MouseEvent(\"click\");\n    //       link.dispatchEvent(event);\n    //       document.body.removeChild(link);\n    //     });\n    //   },\n    //   false\n    // );\n    this.downloadURI(\n      this.makeTextFile(JSON.stringify(this.savedRender)),\n      \"shapes.json\"\n    );\n  };\n  downloadURI = (uri, name) => {\n    var link = document.createElement(\"a\");\n    link.download = name;\n    link.href = uri;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  };\n  saveImage = () => {\n    const dataURL = this.stageRef.current\n      .getStage()\n      .toDataURL({ pixelRatio: 3 });\n    this.downloadURI(dataURL, \"stage.png\");\n  };\n\n  renderArrayOfShapes = shape => {\n    let array = [];\n    let loopShape = [];\n    let count = 0;\n    while (array.length < shape.numToRender || count < 1000) {\n      let x = placeInZone(window.innerWidth - this.state.sideBar);\n      let y = placeInZone(window.innerHeight);\n      let noIn = true;\n      // let pos=placementInter( window,[...this.savedRender,...loopShape] )\n      let otherBodys = [...loopShape, ...this.savedRender];\n      for (let i = 0; i < otherBodys.flat().length; i++) {\n        const pos = otherBodys.flat()[i];\n        if (\n          pos.pos &&\n          x > pos.pos.x - 100 &&\n          x < pos.pos.x + 100 &&\n          y > pos.pos.y - 100 &&\n          y < pos.pos.y + 100\n        ) {\n          console.log(\"overlap\");\n          noIn = false;\n          count++;\n        }\n        // console.log(pos.pos, \"pos\");\n      }\n      if (noIn) {\n        array.push(\n          <SvgRender\n            key={y}\n            src={shape.image}\n            x={x}\n            y={y}\n            scale={shape.minSize}\n          />\n        );\n        loopShape.push({ ...shape, pos: { x, y } });\n      }\n    }\n    this.savedRender.push(loopShape);\n    return array;\n  };\n\n  shapeRender = () => {\n    const render = this.state.shapes.map(shape => {\n      return this.renderArrayOfShapes(shape);\n    });\n    // this.savedRender = render;\n    return render;\n  };\n\n  render() {\n    return (\n      <>\n        <Stage\n          ref={this.stageRef}\n          width={window.innerWidth - this.state.sideBar}\n          height={window.innerHeight}\n        >\n          <Layer>\n            <Rect\n              x={0}\n              y={0}\n              width={window.innerWidth - this.state.sideBar}\n              height={window.innerHeight}\n              fill=\"white\"\n            />\n          </Layer>\n          <Layer>\n            {this.shapeRender()}\n            {/* <SvgRender src={icon} x={300} y={800} scale={8} /> */}\n          </Layer>\n        </Stage>\n        <div style={{ display: \"flex\", flexDirection: \"column\" }}>\n          <button onClick={this.posAllShapes}>mix</button>\n          <button onClick={this.saveImage}>Save Image</button>\n          <button onClick={this.saveFile}>Save set</button>\n        </div>\n\n        <div id=\"create\"></div>\n      </>\n    );\n  }\n}\n\nexport default Canvas;\n"]},"metadata":{},"sourceType":"module"}