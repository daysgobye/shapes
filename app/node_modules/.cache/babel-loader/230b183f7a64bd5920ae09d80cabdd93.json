{"ast":null,"code":"import _objectSpread from\"/Users/coles/Documents/brett/react/shapes/app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/Users/coles/Documents/brett/react/shapes/app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/coles/Documents/brett/react/shapes/app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/coles/Documents/brett/react/shapes/app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/coles/Documents/brett/react/shapes/app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/coles/Documents/brett/react/shapes/app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from\"react\";import Canvg from\"canvg\";import logo from\"./logo.svg\";import icon from\"../ic.svg\";import Konva from\"konva\";import{Stage,Layer,Image,Rect}from\"react-konva\";import SvgRender from\"./svgRender\";import{placement,placeInZone}from\"../helpers.js/placement\";var Canvas=/*#__PURE__*/function(_Component){_inherits(Canvas,_Component);function Canvas(props){var _this;_classCallCheck(this,Canvas);_this=_possibleConstructorReturn(this,_getPrototypeOf(Canvas).call(this,props));_this.posAllShapes=function(){_this.setState({shapes:placement(_this.props.shapes,window.innerWidth,window.innerHeight)},function(){// this.saveFile();\n// this.saveImage();\n});};_this.savedRender=[];_this.textFile=null;_this.makeTextFile=function(text){var data=new Blob([text],{type:\"text/plain\"});// If we are replacing a previously generated file we need to\n// manually revoke the object URL to avoid memory leaks.\nif(_this.textFile!==null){window.URL.revokeObjectURL(_this.textFile);}_this.textFile=window.URL.createObjectURL(data);// returns a URL you can use as a href\nreturn _this.textFile;};_this.saveFile=function(){// var create = document.getElementById(\"create\");\n// create.addEventListener(\n//   \"click\",\n//   function() {\n//     var link = document.createElement(\"a\");\n//     link.setAttribute(\"download\", \"shapes.txt\");\n//     link.href = this.makeTextFile(JSON.stringify(this.state.shapes));\n//     document.body.appendChild(link);\n//     // wait for the link to be added to the document\n//     window.requestAnimationFrame(function() {\n//       var event = new MouseEvent(\"click\");\n//       link.dispatchEvent(event);\n//       document.body.removeChild(link);\n//     });\n//   },\n//   false\n// );\n_this.downloadURI(_this.makeTextFile(JSON.stringify(_this.savedRender)),\"shapes.json\");};_this.downloadURI=function(uri,name){var link=document.createElement(\"a\");link.download=name;link.href=uri;document.body.appendChild(link);link.click();document.body.removeChild(link);};_this.saveImage=function(){var dataURL=_this.stageRef.current.getStage().toDataURL({pixelRatio:3});_this.downloadURI(dataURL,\"stage.png\");};_this.renderArrayOfShapes=function(shape){var array=[];var loopShape=[];for(var i=0;i<shape.numToRender;i++){var x=placeInZone(window.innerWidth-_this.state.sideBar);var y=placeInZone(window.innerHeight);array.push(React.createElement(SvgRender,{src:shape.image,x:x,y:y,scale:shape.minSize}));loopShape.push(_objectSpread({},shape,{pos:{x:x,y:y}}));}_this.savedRender.push(loopShape);return array;};_this.shapeRender=function(){var render=_this.state.shapes.map(function(shape){return _this.renderArrayOfShapes(shape);});// this.savedRender = render;\nreturn render;};_this.state={shapes:[],sideBar:600};_this.stageRef=React.createRef();return _this;}_createClass(Canvas,[{key:\"render\",value:function render(){return React.createElement(React.Fragment,null,React.createElement(Stage,{ref:this.stageRef,width:window.innerWidth-this.state.sideBar,height:window.innerHeight},React.createElement(Layer,null,React.createElement(Rect,{x:0,y:0,width:window.innerWidth-this.state.sideBar,height:window.innerHeight,fill:\"white\"})),React.createElement(Layer,null,this.shapeRender())),React.createElement(\"div\",{style:{display:\"flex\",flexDirection:\"column\"}},React.createElement(\"button\",{onClick:this.posAllShapes},\"mix\"),React.createElement(\"button\",{onClick:this.saveImage},\"Save Image\"),React.createElement(\"button\",{onClick:this.saveFile},\"Save set\")),React.createElement(\"div\",{id:\"create\"}));}}]);return Canvas;}(Component);export default Canvas;","map":{"version":3,"sources":["/Users/coles/Documents/brett/react/shapes/app/src/componets/canvas.js"],"names":["React","Component","Canvg","Konva","Stage","Layer","Image","Rect","SvgRender","placement","placeInZone","Canvas","props","posAllShapes","setState","shapes","window","innerWidth","innerHeight","savedRender","textFile","makeTextFile","text","data","Blob","type","URL","revokeObjectURL","createObjectURL","saveFile","downloadURI","JSON","stringify","uri","name","link","document","createElement","download","href","body","appendChild","click","removeChild","saveImage","dataURL","stageRef","current","getStage","toDataURL","pixelRatio","renderArrayOfShapes","shape","array","loopShape","i","numToRender","x","state","sideBar","y","push","image","minSize","pos","shapeRender","render","map","createRef","display","flexDirection"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Canvg from \"canvg\";\nimport logo from \"./logo.svg\";\nimport icon from \"../ic.svg\";\nimport Konva from \"konva\";\nimport { Stage, Layer, Image, Rect } from \"react-konva\";\nimport SvgRender from \"./svgRender\";\nimport { placement, placeInZone } from \"../helpers.js/placement\";\nclass Canvas extends Component {\n  constructor(props) {\n    super(props);\n    this.state = { shapes: [], sideBar: 600 };\n    this.stageRef = React.createRef();\n  }\n  posAllShapes = () => {\n    this.setState(\n      {\n        shapes: placement(\n          this.props.shapes,\n          window.innerWidth,\n          window.innerHeight\n        )\n      },\n      () => {\n        // this.saveFile();\n        // this.saveImage();\n      }\n    );\n  };\n  savedRender = [];\n  textFile = null;\n\n  makeTextFile = text => {\n    var data = new Blob([text], { type: \"text/plain\" });\n\n    // If we are replacing a previously generated file we need to\n    // manually revoke the object URL to avoid memory leaks.\n    if (this.textFile !== null) {\n      window.URL.revokeObjectURL(this.textFile);\n    }\n\n    this.textFile = window.URL.createObjectURL(data);\n\n    // returns a URL you can use as a href\n    return this.textFile;\n  };\n\n  saveFile = () => {\n    // var create = document.getElementById(\"create\");\n    // create.addEventListener(\n    //   \"click\",\n    //   function() {\n    //     var link = document.createElement(\"a\");\n    //     link.setAttribute(\"download\", \"shapes.txt\");\n    //     link.href = this.makeTextFile(JSON.stringify(this.state.shapes));\n    //     document.body.appendChild(link);\n\n    //     // wait for the link to be added to the document\n    //     window.requestAnimationFrame(function() {\n    //       var event = new MouseEvent(\"click\");\n    //       link.dispatchEvent(event);\n    //       document.body.removeChild(link);\n    //     });\n    //   },\n    //   false\n    // );\n    this.downloadURI(\n      this.makeTextFile(JSON.stringify(this.savedRender)),\n      \"shapes.json\"\n    );\n  };\n  downloadURI = (uri, name) => {\n    var link = document.createElement(\"a\");\n    link.download = name;\n    link.href = uri;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  };\n  saveImage = () => {\n    const dataURL = this.stageRef.current\n      .getStage()\n      .toDataURL({ pixelRatio: 3 });\n    this.downloadURI(dataURL, \"stage.png\");\n  };\n\n  renderArrayOfShapes = shape => {\n    let array = [];\n    let loopShape = [];\n    for (let i = 0; i < shape.numToRender; i++) {\n      let x = placeInZone(window.innerWidth - this.state.sideBar);\n      let y = placeInZone(window.innerHeight);\n      array.push(\n        <SvgRender src={shape.image} x={x} y={y} scale={shape.minSize} />\n      );\n      loopShape.push({ ...shape, pos: { x, y } });\n    }\n    this.savedRender.push(loopShape);\n    return array;\n  };\n\n  shapeRender = () => {\n    const render = this.state.shapes.map(shape => {\n      return this.renderArrayOfShapes(shape);\n    });\n    // this.savedRender = render;\n    return render;\n  };\n\n  render() {\n    return (\n      <>\n        <Stage\n          ref={this.stageRef}\n          width={window.innerWidth - this.state.sideBar}\n          height={window.innerHeight}\n        >\n          <Layer>\n            <Rect\n              x={0}\n              y={0}\n              width={window.innerWidth - this.state.sideBar}\n              height={window.innerHeight}\n              fill=\"white\"\n            />\n          </Layer>\n          <Layer>\n            {this.shapeRender()}\n            {/* <SvgRender src={icon} x={300} y={800} scale={8} /> */}\n          </Layer>\n        </Stage>\n        <div style={{ display: \"flex\", flexDirection: \"column\" }}>\n          <button onClick={this.posAllShapes}>mix</button>\n          <button onClick={this.saveImage}>Save Image</button>\n          <button onClick={this.saveFile}>Save set</button>\n        </div>\n\n        <div id=\"create\"></div>\n      </>\n    );\n  }\n}\n\nexport default Canvas;\n"]},"metadata":{},"sourceType":"module"}